webpackJsonp([20],{"3cXf":function(t,e,a){t.exports={default:a("I4CF"),__esModule:!0}},"8PYF":function(t,e,a){var r=a("bxgu");"string"==typeof r&&(r=[[t.i,r,""]]),r.locals&&(t.exports=r.locals);a("8bSs")("1d5a638c",r,!1)},I4CF:function(t,e,a){var r=a("0nnt"),n=r.JSON||(r.JSON={stringify:JSON.stringify});t.exports=function(t){return n.stringify.apply(n,arguments)}},MDSL:function(t,e,a){"use strict";(function(t){var r=a("3cXf"),n=a.n(r);e.a={name:"materialPrice",data:function(){var e=this;return{editModal:!1,dataList:[],dataLoading:!1,submitLoading:!1,tagList:{sex:null,type:null},editItem:{},styleArray:[],addStyleArray:[],searchForm:{searchTerm:"",gender:"",style:"",type:"",minPrice:0,maxPrice:0,page:0,pageLength:10},dataTitle:[{title:"面料名称",align:"center",key:"materialName"},{title:"面料编号",align:"center",key:"materialNo"},{title:"颜色",align:"center",render:function(e,a){return t.isEmpty(a.row.colorSet)?"--":a.row.colorSet.join("/")}},{title:"成分",align:"center",key:"content"},{title:"短款",align:"center",render:function(t,a){return e.styleDataFilter(a.row.shortStyle,t)}},{title:"中长款",align:"center",render:function(t,a){return e.styleDataFilter(a.row.midLengthStyle,t)}},{title:"长款",align:"center",render:function(t,a){return e.styleDataFilter(a.row.longStyle,t)}},{title:"超长款",align:"center",render:function(t,a){return e.styleDataFilter(a.row.superLongStyle,t)}},{title:"非常规款",align:"center",render:function(t,a){return e.styleDataFilter(a.row.unnormalStyle,t)}},{title:"操作",align:"center",key:"edit",render:function(t,a){return t("Button",{props:{type:"text"},on:{click:function(){e.editItem=a.row,e.editModal=!0,e.styleArray=[],e.styleArray.push(a.row.shortStyle),e.styleArray.push(a.row.superLongStyle),e.styleArray.push(a.row.midLengthStyle),e.styleArray.push(a.row.unnormalStyle),e.styleArray.push(a.row.longStyle),e.addStyleItem(!0)}}},"编辑")}}]}},created:function(){this.getDataList(),this.getTagList()},methods:{getDataList:function(e){var a=this;t.isNumber(e)&&(this.searchForm.page=e-1),this.dataLoading=!0,this.searchForm.searchTerm=this.searchForm.searchTerm.trim(),this.ajax.post("/v3/store/material/findAllPrice",this.searchForm).then(function(t){a.dataList=t,a.dataLoading=!1}).catch(function(){a.dataLoading=!1})},getTagList:function(){var e=this;this.ajax.get("/v3/store/tag/getSearchTagList").then(function(a){e.tagList.sex=t.where(a,{tagType:1}),e.tagList.type=t.where(a,{tagType:2})})},resetForm:function(){this.searchForm=this.$options.data().searchForm,this.getDataList()},addStyleItem:function(t){var e={genderName:"",styleName:"",typeName:"",price1:0,price2:0};t?this.addStyleArray=[e]:this.addStyleArray.push(e)},deleteStyleItem:function(e,a,r){if(1===a&&(this.addStyleArray=t.filter(this.addStyleArray,function(t,a){return a!==e})),2===a){var n=this.styleArray[r],i=t.filter(n,function(t,a){return a!==e});this.$set(this.styleArray,r,i)}},submitEdit:function(){var e=this,a=t.flatten(this.styleArray);if(this.submitLoading=!0,t.map(this.addStyleArray,function(r,n){if(e.submitLoading)return r.genderName&&r.styleName&&r.typeName&&r.price1||!(r.genderName||r.styleName||r.typeName||r.price1)?void t.map(a,function(t){r.genderName===t.genderName&&r.styleName===t.styleName&&r.typeName===t.typeName&&(e.$Message.warning("已存在相同面料定价"),e.submitLoading=!1)}):(e.$Message.warning("请填写完整信息"),e.submitLoading=!1)}),!this.submitLoading)return!1;t.map(this.addStyleArray,function(t){t.genderName&&a.push(t)}),this.ajax.post("/v3/store/material/updatePriceInfo",{marterialNo:this.editItem.materialNo,priceList:n()(a)}).then(function(t){e.getDataList(),e.$Message.success("编辑成功！"),e.editModal=!1,e.submitLoading=!1}).catch(function(){e.submitLoading=!1})},styleDataFilter:function(e,a){var r=[],n=void 0;if(t.map(e,function(t,e){r.push(a("li",""+t.genderName+t.typeName+"：¥"+t.price1+" / ¥"+t.price2))}),t.isEmpty(r))n="--";else if(r.length>2){var i=t.filter(r,function(t,e){return e<2});i.push(a("li","点击查看更多")),n=a("Poptip",{props:{placement:"right",width:200,trigger:"click"}},[a("ul",i),a("ul",{slot:"content"},r)])}else n=a("ul",r);return n}}}}).call(e,a("u47Y"))},TPsb:function(t,e,a){"use strict";var r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"material-price tx-container"},[a("div",{staticClass:"tx-form-search"},[a("Form",{ref:"searchForm",attrs:{model:t.searchForm,"label-width":65,inline:""}},[a("FormItem",{attrs:{label:"关键字"}},[a("Input",{attrs:{placeholder:"搜索面料名称/编号"},model:{value:t.searchForm.searchTerm,callback:function(e){t.$set(t.searchForm,"searchTerm",e)},expression:"searchForm.searchTerm"}})],1),t._v(" "),a("FormItem",{attrs:{label:"性别标签"}},[a("Select",{attrs:{clearable:"",placeholder:"全部"},model:{value:t.searchForm.gender,callback:function(e){t.$set(t.searchForm,"gender",e)},expression:"searchForm.gender"}},t._l(t.tagList.sex,function(e){return a("Option",{key:e.tagId,attrs:{value:e.tagName}},[t._v(t._s(e.tagName))])}))],1),t._v(" "),a("FormItem",{attrs:{label:"款式标签"}},[a("Select",{attrs:{clearable:"",placeholder:"全部"},model:{value:t.searchForm.style,callback:function(e){t.$set(t.searchForm,"style",e)},expression:"searchForm.style"}},[a("Option",{attrs:{value:"短款"}},[t._v("短款")]),t._v(" "),a("Option",{attrs:{value:"中长款"}},[t._v("中长款")]),t._v(" "),a("Option",{attrs:{value:"长款"}},[t._v("长款")]),t._v(" "),a("Option",{attrs:{value:"超长款"}},[t._v("超长款")]),t._v(" "),a("Option",{attrs:{value:"非常规款"}},[t._v("非常规款")])],1)],1),t._v(" "),a("FormItem",{attrs:{label:"分类标签"}},[a("Select",{attrs:{clearable:"",placeholder:"全部"},model:{value:t.searchForm.type,callback:function(e){t.$set(t.searchForm,"type",e)},expression:"searchForm.type"}},t._l(t.tagList.type,function(e){return a("Option",{key:e.tagId,attrs:{value:e.tagName}},[t._v(t._s(e.tagName))])}))],1),t._v(" "),a("br"),t._v(" "),a("FormItem",{attrs:{label:"价格区间"}},[a("InputNumber",{attrs:{step:50,min:0,placeholder:"最小值"},model:{value:t.searchForm.minPrice,callback:function(e){t.$set(t.searchForm,"minPrice",e)},expression:"searchForm.minPrice"}}),t._v("\n          ~  \n        "),a("InputNumber",{attrs:{step:50,placeholder:"最大值"},model:{value:t.searchForm.maxPrice,callback:function(e){t.$set(t.searchForm,"maxPrice",e)},expression:"searchForm.maxPrice"}})],1),t._v(" "),a("Button",{attrs:{type:"primary"},on:{click:function(e){t.getDataList(1)}}},[t._v("查询")]),t._v(" "),a("Button",{staticStyle:{"margin-left":"8px"},attrs:{type:"ghost"},on:{click:t.resetForm}},[t._v("重置")])],1)],1),t._v(" "),a("Table",{attrs:{border:"",columns:t.dataTitle,data:t.dataList.data}}),t._v(" "),a("div",{staticStyle:{"text-align":"right",width:"100%","margin-top":"30px"}},[a("Page",{attrs:{total:t.dataList.totalSize,"show-total":"","show-elevator":""},on:{"on-change":t.getDataList}})],1),t._v(" "),a("Modal",{attrs:{title:"编辑价格",width:700,"mask-closable":!1,styles:{top:"50px"}},model:{value:t.editModal,callback:function(e){t.editModal=e},expression:"editModal"}},[a("h4",[a("span",{domProps:{textContent:t._s(t.editItem.materialName)}}),t._v("  \n      "),a("span",{domProps:{textContent:t._s(t.editItem.materialNo)}}),t._v("  \n      "),t.editItem.colorSet?a("span",{domProps:{textContent:t._s(t.editItem.colorSet.join("/"))}}):t._e()]),a("br"),t._v(" "),a("Row",{staticClass:"edit-row"},[a("Col",{attrs:{span:"4"}},[t._v("\n      选择性别")]),t._v(" "),a("Col",{attrs:{span:"4"}},[t._v("\n      选择款式")]),t._v(" "),a("Col",{attrs:{span:"4"}},[t._v("\n      选择分类")]),t._v(" "),a("Col",{attrs:{span:"4"}},[t._v("\n      输入常规价格")]),t._v(" "),a("Col",{attrs:{span:"4"}},[t._v("\n      输入精品价格")])],1),t._v(" "),t._l(t.addStyleArray,function(e,r){return a("Row",{key:r,staticClass:"edit-row-input"},[a("Col",{attrs:{span:"4"}},[a("Select",{attrs:{placeholder:"性别"},model:{value:e.genderName,callback:function(a){t.$set(e,"genderName",a)},expression:"item.genderName"}},t._l(t.tagList.sex,function(e,r){return a("Option",{key:r,attrs:{value:e.tagName}},[t._v(t._s(e.tagName))])}))],1),t._v(" "),a("Col",{attrs:{span:"4"}},[a("Select",{attrs:{placeholder:"款式"},model:{value:e.styleName,callback:function(a){t.$set(e,"styleName",a)},expression:"item.styleName"}},[a("Option",{attrs:{value:"短款"}},[t._v("短款")]),t._v(" "),a("Option",{attrs:{value:"中长款"}},[t._v("中长款")]),t._v(" "),a("Option",{attrs:{value:"长款"}},[t._v("长款")]),t._v(" "),a("Option",{attrs:{value:"超长款"}},[t._v("超长款")]),t._v(" "),a("Option",{attrs:{value:"非常规款"}},[t._v("非常规款")])],1)],1),t._v(" "),a("Col",{attrs:{span:"4"}},[a("Select",{attrs:{placeholder:"分类"},model:{value:e.typeName,callback:function(a){t.$set(e,"typeName",a)},expression:"item.typeName"}},t._l(t.tagList.type,function(e,r){return a("Option",{key:r,attrs:{value:e.tagName}},[t._v(t._s(e.tagName))])}))],1),t._v(" "),a("Col",{attrs:{span:"4"}},[t._v("\n      ¥ "),a("InputNumber",{attrs:{min:0,step:50},model:{value:e.price1,callback:function(a){t.$set(e,"price1",a)},expression:"item.price1"}})],1),t._v(" "),a("Col",{attrs:{span:"4"}},[t._v("\n      ¥ "),a("InputNumber",{attrs:{min:0,step:50},model:{value:e.price2,callback:function(a){t.$set(e,"price2",a)},expression:"item.price2"}})],1),t._v(" "),r+1===t.addStyleArray.length?a("Col",{attrs:{span:"2"}},[a("Button",{attrs:{type:"primary",icon:"android-add"},on:{click:function(e){t.addStyleItem()}}})],1):a("Col",{attrs:{span:"2"}},[a("Button",{attrs:{type:"primary",icon:"android-remove"},on:{click:function(e){t.deleteStyleItem(r,1)}}})],1)],1)}),t._v(" "),t._l(t.styleArray,function(e,r){return t._l(e,function(e,n){return a("Row",{key:n,staticClass:"edit-row"},[a("Col",{attrs:{span:"4"}},[t._v("\n        "+t._s(e.genderName))]),t._v(" "),a("Col",{attrs:{span:"4"}},[t._v("\n        "+t._s(e.styleName))]),t._v(" "),a("Col",{attrs:{span:"4"}},[t._v("\n        "+t._s(e.typeName))]),t._v(" "),a("Col",{attrs:{span:"4"}},[t._v("\n        ¥"+t._s(e.price1))]),t._v(" "),a("Col",{attrs:{span:"4"}},[t._v("\n        ¥"+t._s(e.price2))]),t._v(" "),a("Col",{attrs:{span:"2"}},[a("Button",{staticStyle:{"font-size":"18px","line-height":"10px"},attrs:{type:"text",icon:"android-delete"},on:{click:function(e){t.deleteStyleItem(n,2,r)}}})],1)],1)})}),t._v(" "),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("Button",{on:{click:function(e){t.editModal=!1}}},[t._v("取消")]),t._v(" "),a("Button",{attrs:{type:"primary",loading:t.submitLoading},on:{click:function(e){t.submitEdit()}}},[t._v("确定")])],1)],2),t._v(" "),t.dataLoading?a("Spin",{attrs:{size:"large",fix:""}}):t._e()],1)},n=[];r._withStripped=!0;var i={render:r,staticRenderFns:n};e.a=i},Wfxj:function(t,e,a){"use strict";function r(t){s||a("8PYF")}Object.defineProperty(e,"__esModule",{value:!0});var n=a("MDSL"),i=a("TPsb"),s=!1,o=a("/Xao"),l=r,c=o(n.a,i.a,!1,l,"data-v-38073bfe",null);c.options.__file="src\\views\\material\\price\\index.vue",c.esModule&&Object.keys(c.esModule).some(function(t){return"default"!==t&&"__"!==t.substr(0,2)})&&console.error("named exports are not supported in *.vue files."),e.default=c.exports},bxgu:function(t,e,a){e=t.exports=a("BkJT")(!1),e.push([t.i,".edit-row .ivu-col[data-v-38073bfe]{line-height:32px;text-align:center}.edit-row-input[data-v-38073bfe]{margin-bottom:8px}.edit-row-input .ivu-col[data-v-38073bfe]{padding-left:10px;padding-right:10px;-webkit-box-sizing:border-box;box-sizing:border-box}",""])}});